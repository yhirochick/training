\documentclass[a4paper,11pt,twocolumn]{article}
\usepackage{luatexja}
\usepackage{luatexja-fontspec}
\usepackage[margin=1.5cm,top=2cm,bottom=2.5cm]{geometry}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{tikz}

% Noto CJK フォント設定
\setmainjfont{Noto Sans CJK JP}

% 禁則処理の設定
\ltjsetparameter{jacharrange={-2}}
\ltjsetparameter{alxspmode={`\!,inhibit}}

% ヘッダー・フッター設定
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[R]{\small\textit{seed: {{ seed }}}}

\title{\vspace{-2cm}\LARGE\textbf{数学演習問題 解答}\vspace{-1cm}}
\author{}
\date{}

\begin{document}

\twocolumn[
  \begin{@twocolumnfalse}
    \maketitle
  \end{@twocolumnfalse}
]

{% if linear_equations %}
\section*{中1: 一次方程式 解答}

\begin{enumerate}[label=(\arabic*)]
{% for problem in linear_equations %}
\item ${{ problem.equation }}$ \\
解: $x = {{ problem.solution }}$
{% endfor %}
\end{enumerate}

\newpage
{% endif %}

{% if proportional_functions %}
\section*{中1: 比例の式を求める（表から） 解答}

\begin{enumerate}[label=(\arabic*)]
{% for problem in proportional_functions %}
\item
\begin{flushleft}
\begin{tabular}{|c|c|c|c|}
\hline
$x$ & \large{{ problem.x_values[0] }} & \large{{ problem.x_values[1] }} & \large{{ problem.x_values[2] }} \\
\hline
$y$ & \large{{ problem.y_values[0] }} & \large{{ problem.y_values[1] }} & \large{{ problem.y_values[2] }} \\
\hline
\end{tabular}
\end{flushleft}
解: $y = {{ problem.solution }}$
{% endfor %}
\end{enumerate}

\newpage
{% endif %}

{% if proportional_conditions %}
\section*{中1: 比例の式を求める（条件から） 解答}

\begin{enumerate}[label=(\arabic*)]
{% for problem in proportional_conditions %}
\item ${{ problem.condition }}$ \\
解: $y = {{ problem.solution }}$
{% endfor %}
\end{enumerate}

\newpage
{% endif %}

{% if proportional_graphs %}
\onecolumn
\subsection*{中1: 比例のグラフ 解答}
\vspace{-0.3cm}

\begin{enumerate}[label=(\arabic*)]
{% for problem in proportional_graphs %}
\item ${{ problem.equation }}$

\begin{flushleft}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
$x$ & \large{{ problem.x_values[0] }} & \large{{ problem.x_values[1] }} & \large{{ problem.x_values[2] }} & \large{{ problem.x_values[3] }} & \large{{ problem.x_values[4] }} \\
\hline
$y$ & \large{{ problem.y_values[0] }} & \large{{ problem.y_values[1] }} & \large{{ problem.y_values[2] }} & \large{{ problem.y_values[3] }} & \large{{ problem.y_values[4] }} \\
\hline
\end{tabular}
\end{flushleft}

\vspace{0.3cm}

\begin{center}
\begin{tikzpicture}[scale=0.7]
  % Grid
  \draw[step=0.5cm,gray,very thin] (-5.5,-5.5) grid (5.5,5.5);
  % Axes
  \draw[thick,->] (-5.5,0) -- (5.5,0) node[right] {$x$};
  \draw[thick,->] (0,-5.5) -- (0,5.5) node[above] {$y$};
  % Tick marks
  \foreach \x in {-5,-4,-3,-2,-1,1,2,3,4,5}
    \draw (\x,0.1) -- (\x,-0.1) node[below,font=\small] {\x};
  \foreach \y in {-5,-4,-3,-2,-1,1,2,3,4,5}
    \draw (0.1,\y) -- (-0.1,\y) node[left,font=\small] {\y};
  % Origin
  \node[below left,font=\small] at (0,0) {O};
  % Plot line (clipped to visible area)
  \clip (-5.5,-5.5) rectangle (5.5,5.5);
  \draw[blue,thick,domain=-5.5:5.5,samples=100] plot (\x,{{{ problem.a }}*\x});
  % Plot points
  \foreach \px/\py in {{{ problem.x_values[0] }}/{{ problem.y_values[0] }},{{ problem.x_values[1] }}/{{ problem.y_values[1] }},{{ problem.x_values[2] }}/{{ problem.y_values[2] }},{{ problem.x_values[3] }}/{{ problem.y_values[3] }},{{ problem.x_values[4] }}/{{ problem.y_values[4] }}}
    \fill[red] (\px,\py) circle (3pt);
\end{tikzpicture}
\end{center}

\vspace{0.5cm}

{% endfor %}
\end{enumerate}

\twocolumn
\newpage
{% endif %}

{% if simultaneous_equations %}
\section*{中2: 連立方程式 解答}

\begin{enumerate}[label=(\arabic*)]
{% for problem in simultaneous_equations %}
\item
$\begin{cases}
{{ problem.eq1 }} \\
{{ problem.eq2 }}
\end{cases}$ \\
解: $x = {{ problem.solution_x }}$, $y = {{ problem.solution_y }}$
{% endfor %}
\end{enumerate}
{% endif %}

\end{document}
